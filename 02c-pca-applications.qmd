---
title: "Principal component analysis: examples"
subtitle: Introduction to Statistical Modelling
author: Prof. Joris Vankerschaver
format:
  beamer:
    theme: Pittsburgh
    colortheme: default
    fonttheme: default
    header-includes: |
      \setbeamertemplate{frametitle}[default][left]
      \setbeamertemplate{footline}[frame number]
      \hypersetup{colorlinks,urlcolor=blue}

---

```{r, include=FALSE}
set.seed(1234)

library(tidyverse)
theme_set(theme_bw() + theme(text = element_text(size = 14)))

```

## Examples

1. Adulteration of olive oil
  - Malavi, Derick, Amin Nikkhah, Katleen Raes, and Sam Van Haute. 2023. "Hyperspectral Imaging and Chemometrics for Authentication of Extra Virgin Olive Oil: A Comparative Approach with FTIR, UV-VIS, Raman, and GC-MS.‚Äù Foods 12 (3): 429. \url{https://doi.org/10.3390/foods12030429}
2. Human faces dataset
  - \url{https://scikit-learn.org/0.19/datasets/olivetti_faces.html}
  
# Adulteration of olive oil

## Problem setting

:::: {.columns}

::: {.column width="50%"}

Extra virgin olive oil (EVOO):
\vspace*{0.5cm}

- High quality
- Flavorful
- Health benefits
- **More expensive** (than regular oil)

\vspace*{1cm}
To reduce cost, EVOO is often **adulterated** with other, cheaper food oils.

:::

::: {.column width="50%"}
![](./images/02b-pca-applications/olive-oil.jpg){height=2in fig-align=center}
:::
::::

## Research questions

1. **Classification:** Can we detect whether a given EVOO sample has been adulterated?
    - Yes/no answer (categorical)
2. **Regression:** Can we detect the degree of adulteration?
    - Continuous answer, from 0% (no adulteration) to 100%

## Hyperspectral imaging (HSI)

![](./images/02b-pca-applications/hyperspectral.png){fig-align=center height=50%}

- Measures reflected infrared light (700-1800 nm) off sample
- Provides a non-destructive way of testing sample


## Hyperspectral "images" (spectra)

![](./images/02b-pca-applications/hsi-spectra.png){fig-align=center height=50%}

- HSI measures reflectance at 224 wavelengths from 700 to 1800 nm
- Reflectance at given wavelength is determined by molecular features of sample

## Experimental setup

Samples to test (61 total):

- 13 different kinds of unadulterated EVOO
- 6 vegetable oils
- 42 adulterated mixtures
  - EVOO + one of 6 vegetable oils at one of 7 different percentages (from 1% to 20%)

Each sample is imaged 3 times: **183 samples**

Each sample produces a HSI spectrum of **length 224**

## Data matrix


