{
  "hash": "41f6b6ace2cae5146ad5b1efbc2e93c3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Prostate cancer\"\nformat: html\n---\n\n\n# EDA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprostate <- read_delim(\"prostatecancer.dat\", delim = \" & \") |>\n  mutate(Nodes = as.factor(Nodes))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 53 Columns: 6\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \" & \"\ndbl (6): Xray, Grade, Stage, Age, Acid, Nodes\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(prostate)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 53\nColumns: 6\n$ Xray  <dbl> 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1…\n$ Grade <dbl> 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1…\n$ Stage <dbl> 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1…\n$ Age   <dbl> 64, 63, 65, 67, 66, 65, 60, 51, 66, 58, 56, 61, 64, 56, 67, 49, …\n$ Acid  <dbl> 40, 40, 46, 47, 48, 48, 49, 49, 50, 50, 50, 50, 50, 52, 52, 55, …\n$ Nodes <fct> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(prostate, aes(x = Acid, y = Nodes, color = Nodes)) +\n  geom_jitter(height = 0.10)\n```\n\n::: {.cell-output-display}\n![](prostate-cancer_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(prostate, aes(x = Acid, y = Nodes, fill = Nodes)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](prostate-cancer_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(prostate, aes(x = Acid, y = Age, color = Nodes)) +\n  geom_jitter()\n```\n\n::: {.cell-output-display}\n![](prostate-cancer_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n# Simple model with online linear term\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_simple <- glm(Nodes ~ Acid, data = prostate, family = \"binomial\")\nsummary(m_simple)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Nodes ~ Acid, family = \"binomial\", data = prostate)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)  \n(Intercept) -1.92703    0.92104  -2.092   0.0364 *\nAcid         0.02040    0.01257   1.624   0.1045  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 70.252  on 52  degrees of freedom\nResidual deviance: 67.116  on 51  degrees of freedom\nAIC: 71.116\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(prostate, aes(x = Acid, y = Nodes, color = Nodes)) +\n  geom_jitter(height = 0.10) +\n  stat_smooth(method=\"glm\", color=\"green\", se=FALSE,\n              formula = Nodes ~ Acid,\n              method.args = list(family=\"binomial\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Failed to fit group 1.\nCaused by error:\n! object 'Nodes' not found\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Failed to fit group 2.\nCaused by error:\n! object 'Nodes' not found\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](prostate-cancer_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprostate |>\n  mutate(pred = predict(m_simple, type = \"response\")) |>\n  ggplot() +\n  geom_line(aes(x = Acid, y = pred))\n```\n\n::: {.cell-output-display}\n![](prostate-cancer_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n# Simple model with quadratic term\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_simple_quad <- glm(Nodes ~ Acid + I(Acid^2), data = prostate, family = \"binomial\")\nsummary(m_simple_quad)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Nodes ~ Acid + I(Acid^2), family = \"binomial\", \n    data = prostate)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)   \n(Intercept) -7.3199554  2.6224591  -2.791  0.00525 **\nAcid         0.1488694  0.0608666   2.446  0.01445 * \nI(Acid^2)   -0.0006616  0.0003279  -2.018  0.04361 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 70.252  on 52  degrees of freedom\nResidual deviance: 60.190  on 50  degrees of freedom\nAIC: 66.19\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npreds <- with(prostate, tibble(\n  Acid = Acid, Nodes = predict(m_simple_quad, type = \"response\")))\n\nggplot(prostate) +\n  geom_line(data = preds, aes(x = Acid, y = Nodes)) #+ \n```\n\n::: {.cell-output-display}\n![](prostate-cancer_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  #geom_jitter(aes(x = Acid, y = as.numeric(Nodes), color = Nodes), height = 0.10)\n```\n:::\n\n\n\n\n# Multiple regression model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_multi <- glm(Nodes ~ Acid + Age, data = prostate, family = \"binomial\")\nsummary(m_multi)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Nodes ~ Acid + Age, family = \"binomial\", data = prostate)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)  \n(Intercept)  1.32811    2.90303   0.457   0.6473  \nAcid         0.02140    0.01251   1.710   0.0872 .\nAge         -0.05639    0.04829  -1.168   0.2429  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 70.252  on 52  degrees of freedom\nResidual deviance: 65.724  on 50  degrees of freedom\nAIC: 71.724\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_multi_interaction <- glm(Nodes ~ Acid*Age, data = prostate, family = \"binomial\")\nsummary(m_multi_interaction)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Nodes ~ Acid * Age, family = \"binomial\", data = prostate)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)\n(Intercept) -2.6120334 13.0199219  -0.201    0.841\nAcid         0.0793956  0.1871999   0.424    0.671\nAge          0.0067499  0.2088275   0.032    0.974\nAcid:Age    -0.0009282  0.0029870  -0.311    0.756\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 70.252  on 52  degrees of freedom\nResidual deviance: 65.627  on 49  degrees of freedom\nAIC: 73.627\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n\n\n# Classification\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: lattice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'caret'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n\n\n:::\n\n```{.r .cell-code}\npred_test <- predict(m_simple, prostate, type=\"response\")\nclass_test <- ifelse(pred_test >= 0.5, 0, 1)\n\nconf_matrix <- confusionMatrix(as.factor(class_test),\n                               as.factor(prostate$Nodes), positive = \"1\")\nprint(conf_matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  0  1\n         0  4  3\n         1 29 17\n                                        \n               Accuracy : 0.3962        \n                 95% CI : (0.2645, 0.54)\n    No Information Rate : 0.6226        \n    P-Value [Acc > NIR] : 0.9997        \n                                        \n                  Kappa : -0.0229       \n                                        \n Mcnemar's Test P-Value : 9.897e-06     \n                                        \n            Sensitivity : 0.8500        \n            Specificity : 0.1212        \n         Pos Pred Value : 0.3696        \n         Neg Pred Value : 0.5714        \n             Prevalence : 0.3774        \n         Detection Rate : 0.3208        \n   Detection Prevalence : 0.8679        \n      Balanced Accuracy : 0.4856        \n                                        \n       'Positive' Class : 1             \n                                        \n```\n\n\n:::\n:::\n",
    "supporting": [
      "prostate-cancer_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}